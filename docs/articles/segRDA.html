<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>segRDA vignette • segRDA </title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="segRDA vignette">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">segRDA </a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/segRDA.html">segRDA vignette </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DaniloCVieira/segRDA">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>segRDA vignette</h1>
                        <h4 class="author">Danilo Cândido Vieira; Marco Colossi Brustolin; Fabio Cop; Gustavo Fonseca.</h4>
            
            <h4 class="date">June 22, 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DaniloCVieira/segRDA/blob/master/vignettes/segRDA.Rmd"><code>vignettes/segRDA.Rmd</code></a></small>
      <div class="hidden name"><code>segRDA.Rmd</code></div>

    </div>

    
    
<p><code>segRDA</code> is designed to model non-continuous linear responses of ecological communities to environmental data. This tutorial assumes familiarity both with R and with community ordination. The package <code>segRDA</code> is available on CRAN or the latest development version can be installed from GitHub using the package <code>devtools</code> : <a href="https://github.com/DaniloCVieira/segRDA" class="uri">https://github.com/DaniloCVieira/segRDA</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># to install the package via CRAN</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"segRDA"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># to install the package via GitHub</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_github</a></span>(<span class="st">"DaniloCVieira/segRDA"</span>)</a></code></pre></div>
<p>The modeling process with <code>segRDA</code> is straightforward through three steps: <strong>(1) data ordering</strong> (function <code>OrdData</code>), <strong>(2) split-moving-window analysis</strong> (function <code>SMW</code>) and <strong>(3) piecewise redundancy analysis</strong> (function <code>pwRDA</code>). <code>segRDA</code> provides example data sets to facilitate reproducible examples. Through the following code we will use the dataset <code>sim3</code> from the package, which is a list composed of two matrices: <code>envi</code> and <code>comm</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(sim3) <span class="co">##Simulated data</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">x&lt;-sim3<span class="op">$</span>envi <span class="co">## matrix of explanatory variables</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">y&lt;-sim3<span class="op">$</span>comm <span class="co">## matrix of response variables</span></a></code></pre></div>
<div id="data-ordering" class="section level1">
<h1 class="hasAnchor">
<a href="#data-ordering" class="anchor"></a>Data ordering</h1>
<p>Both the SMW and pwRDA analyses depend on ordered datasets. The ordering can be user-defined or generated using <code>OrdData</code> function. The latter is a wrapper for (1) performing a redundancy analysis using the <code>rda</code> function from <code>vegan</code> package and (2) ordering both response and explanatory matrices using one of the axes of the RDA model. Defaults to use the first RDA axis. <code>rda</code> arguments can be passed directly to the <code>OrdData</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">sim1o&lt;-<span class="kw">OrdData</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y, <span class="dt">axis=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">xo&lt;-sim1o<span class="op">$</span>xo <span class="co">## ordered explanatory matrix</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">yo&lt;-sim1o<span class="op">$</span>yo <span class="co">## ordered response matrix</span></a></code></pre></div>
<p>The resulting ordered community can be represented by a species-site interaction matrix using the function <code>image</code>, which is available from the stats package of R.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">mgp =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">cex =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(y, <span class="dt">main =</span> <span class="st">"Original community data"</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span>(<span class="dv">100</span>), </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">"Sites"</span>, <span class="dt">ylab =</span> <span class="st">"Species abundance"</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(yo, <span class="dt">main =</span> <span class="st">"Ordered comunity data"</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span>(<span class="dv">100</span>), </a>
<a class="sourceLine" id="cb4-5" data-line-number="5">    <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">"Sites"</span>)</a></code></pre></div>
<p><img src="segRDA_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
<div id="split-moving-window-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#split-moving-window-analysis" class="anchor"></a>Split-moving window analysis</h1>
<div id="a-brief-overview-of-the-smw-analysis-" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-overview-of-the-smw-analysis-" class="anchor"></a>A brief overview of the SMW analysis.</h2>
<p>The application of SMW applied to a species matrix allows consists of (1) placing a window of even-numbered size at the beginning of the data series, (2) splitting the window into two equal halves, (3) calculating the community centroids within each half, (4) computing a dissimilarity metric between the two halves, (5) shifting window one position along the series, and (6) repeating the procedure till the end of the data series (Cornelius &amp; Reynolds 1991). The significance of the dissimilarity values within each window is tested through multi-response permutations and includes two types of procedures: the <strong>“random-plot”</strong> and <strong>“random-shift”</strong>. The first randomizes sites along the series while preserving species composition and abundance structure of the sites. The second randomizes patterns of each species relative to each other while preserving the spatial structure of the species abundance. Therefore, choosing between random plot and random shift relies on considering sites or species as a fixed aspect of the null distribution. Both procedures include computing an expected mean dissimilarity (DS) and standard deviation (SD) for each window midpoint. Confidence limits have been suggested as one or two SD above DS or estimated from one-tailed 95% confidence intervals (Erdos et al. 2014).</p>
<p>The choice of window size affects the results of the SMW analysis. A <em>pooled</em> profile by averaging together dissimilarities from different window sizes reduces the scale-effect. In this case, dissimilarity profiles of the mean Z-score (standardized values of dissimilarity) are used to detect the community breakpoints.</p>
<p>In plot randomization, Z-scores increase at each window midpoint together with an increase in window width, but the general shape of the dissimilarity profiles remains unchanged. In contrast, the random-shift method minimizes the scale dependence of Z-scores and makes a clear distinction between non-significant and significant discontinuities (Körmöczi et al. 2016).</p>
</div>
<div id="the-function-smw" class="section level2">
<h2 class="hasAnchor">
<a href="#the-function-smw" class="anchor"></a>The function SMW</h2>
<p>The package <code>segRDA</code> implements the SMW analysis through the function <code>SMW</code> which requires the following arguments:</p>
<ul>
<li>
<code>yo</code>: the ordered community;</li>
<li>
<code>ws</code>: either a single window size or a vector of several windows sizes;</li>
<li>
<code>dist</code>: the distance metric (all distances metrics available in <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegan::vegdist</a></code>);</li>
<li>
<code>rand</code>: the randomization type (<code>"shift"</code> or <code>"plot"</code>);</li>
<li>
<code>n.rand</code>: the number of randomizations;</li>
</ul>
<p>The default settings are <code>dist="bray"</code>, <code>rand="shift"</code> and <code>n.rand=99</code>. The running time of the analysis will depend on the number of window sizes (<code><a href="https://rdrr.io/r/base/length.html">length(ws)</a></code>) multiplied by the number of randomizations <code>n.rand</code>. In the following examples, we settled a low number of randomizations to speed up the analyses with the remaining arguments left at their default values.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">ws20&lt;-<span class="kw">SMW</span>(<span class="dt">yo=</span>yo,<span class="dt">ws=</span><span class="dv">20</span>, <span class="dt">n.rand=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">##  SMW analysis (1/1); w =20</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">pool&lt;-<span class="kw">SMW</span>(<span class="dt">y=</span>yo,<span class="dt">ws=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>), <span class="dt">n.rand=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">##  SMW analysis (1/4); w =10</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">##  SMW analysis (2/4); w =20</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">##  SMW analysis (3/4); w =30</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">##  SMW analysis (4/4); w =40</span></a></code></pre></div>
<p><code>SMW</code> returns invisibly an <code>smw</code> object, which is a two-level list object describing the SMW results for each window <code>w</code> analyzed. Each of the <code>w</code> slots is a list containing the following results:</p>
<ul>
<li>
<code>..$dp</code>: The raw dissimilarity profile table (DP): a data frame giving the positions, labels, values of dissimilarity and z-scores for each sample;</li>
<li>
<code>..$rdp</code>: data frame containing the randomized DP;</li>
<li>
<code>..$md</code>: mean dissimilarity of the randomized DP;</li>
<li>
<code>..$sd</code>: standard deviation for each sample position;</li>
<li>
<code>..$oem</code>: overall expected mean dissimilarity;</li>
<li>
<code>..$osd</code>: average standard deviation for the dissimilarities;</li>
<li>
<code>..$params</code>: list with input arguments.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(ws20)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">## [1] "smw"</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ws20)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">## [1] 1</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(ws20)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">## [1] "w20"</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(pool)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">## [1] "smw"</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(pool)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">## [1] 4</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(pool)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">## [1] "w10" "w20" "w30" "w40"</span></a></code></pre></div>
</div>
<div id="methods-for-extracting-and-plotting-the-smw-results" class="section level2">
<h2 class="hasAnchor">
<a href="#methods-for-extracting-and-plotting-the-smw-results" class="anchor"></a>Methods for extracting and plotting the SMW results</h2>
<div id="extract" class="section level3">
<h3 class="hasAnchor">
<a href="#extract" class="anchor"></a><code>extract</code>
</h3>
<p>The function <code>extract</code> allows the user to access the results cointained in a <code>smw</code> object. The argument <code>index</code> specifies which of the results described above will be extracted. By default, <code>extract</code> returns an object of class <code>dp</code>: a DP table containing significant discontinuities and suggested breakpoints. Extracting a <code>dp</code> object implements the following auxiliary arguments:</p>
<ul>
<li>
<code>sig</code>: defines the statistical test used to detect significant discontinuities. The statistical tests available are <code>"z"</code>,<code>"sd"</code>,<code>"sd2"</code>, and <code>"tail1"</code>;</li>
<li>
<code>z</code>: sets the critical value valor for z-scores when <code>sig="z"</code>;</li>
<li>
<code>BPs</code>: defines if the breakpoints should be chosen as those site positions corresponding to the maximum dissimilarity in a sequence of significant dissimilarity values (<code>BPs="max"</code>) or as those site positions corresponding to the median position of the sequence (<code>BPs="median"</code>). If <code>NULL</code> the breakpoints are not computed;</li>
<li>
<code>seq.sig</code>: specifies the length of a sequence of significant dissimilarity values that will be considered in defining the community breakpoints.</li>
</ul>
<p>The default settings are <code>index="dp"</code>, <code>sig="z"</code>, <code>z="1.85"</code>, <code>BPs="max"</code> and <code>seq.sig=3</code>. The returned <code>dp</code> object has its own generic <code>print</code> method, <code>print.dp</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">ws20_dp&lt;-<span class="kw">extract</span>(ws20) </a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">## Selected index: 'dp'</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">## 1 window size(s) available in 'smw': 20</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">## Window size selected: 20</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## Number of breakpoints detected: 2</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">## Breakpoint positions:  19, 58</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">ws20_dp[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,]</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">##   positions sampleID   diss     zscore sig:z bp</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">## 1        10       88 0.1590 -0.2088400    ns  -</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">## 2        11       59 0.1530 -0.4406134    ns  -</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">## 3        12       12 0.1585 -0.2281545    ns  -</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">## 4        13       78 0.1710  0.2547067    ns  -</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">## 5        14       49 0.1915  1.0465991    ns  -</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">## 6        15       72 0.1780  0.5251090    ns  -</span></a></code></pre></div>
<p>When the <code>smw</code> object handles multiple window sizes (hereafter referred to as <em>pooled</em> <code>smw</code> objects), the extracted DP table will contain the z-scores averaged over the set of window sizes.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pool_dp&lt;-<span class="kw">extract</span>(pool) </a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">## Selected index: 'dp'</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">## Window sizes averaged: 10, 20, 30, 40</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">## Number of breakpoints detected: 2</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">## Breakpoint positions:  20, 57</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(pool_dp)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">##   positions SiteID Average_diss Average_z sig:Z bp</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">## 1         5     22       0.1750 -1.496406    ns  -</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">## 2         6     79       0.1120 -3.126613    ns  -</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">## 3         7     69       0.1090 -3.204242    ns  -</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">## 4         8     89       0.1260 -2.764345    ns  -</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">## 5         9     19       0.1350 -2.531458    ns  -</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">## 6        10     88       0.1445 -1.361368    ns  -</span></a></code></pre></div>
<p>A specific DP can be extracted from <em>pooled</em> objects by specifying a target window size (argument <code>w</code>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">ws10_dp&lt;-<span class="kw">extract</span>(pool, <span class="dt">w=</span><span class="dv">10</span>) </a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">## Selected index: 'dp'</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">## 4 window size(s) available in 'smw': 10, 20, 30, 40</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">## Window size selected: 10</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">## DP without any significant dissimilarity value: no breakpoint could be determined.</span></a></code></pre></div>
<p>The length of consecutive, significant dissimilarity values (argument <code>seq.sig</code>) is used as criteria for defining breakpoints. The function will display a warning if <code>seq.sig</code> exceeds the maximum threshold:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">ws20_dp&lt;-<span class="kw">extract</span>(ws20, <span class="dt">sig=</span><span class="st">"tail1"</span>, <span class="dt">seq.sig=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">## Selected index: 'dp'</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">## 1 window size(s) available in 'smw': 20</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">## Window size selected: 20</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">## Warning: DP shows '19' significant dissimilarity values but no breakpoint could be determined for </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">##  'seq.sig=20' </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">##  </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">## Summary stats of consecutive, significant dissimilarity values for detecting breakpoints in 'smw': </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">##    6.00    7.75    9.50    9.50   11.25   13.00</span></a></code></pre></div>
<p>The function <code>bp</code> is an auxiliary tool for displaying the breakpoints positions in objects of class <code>dp</code> (if present):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">bp</span>(ws10_dp)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">## numeric(0)</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">bp</span>(pool_dp)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">## [1] 20 57</span></a></code></pre></div>
<p>Note that all other results contained in <code>smw</code> objects (i.e. <code>rdp</code>, <code>md</code>, <code>sd</code>, <code>oem</code>, <code>osd</code> and <code>params</code> ) comprise results of single window sizes. Thus, the argument <code>w</code> must be specified to access them from <em>pooled</em> objects.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">extract</span>(pool, <span class="dt">w=</span><span class="dv">10</span>, <span class="dt">index=</span><span class="st">"osd"</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">## Selected index: 'osd'</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">## 4 window size(s) available in 'smw': 10, 20, 30, 40</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">## Window size selected: 10</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">## [1] 0.03864541</span></a></code></pre></div>
</div>
<div id="plot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot" class="anchor"></a><code>plot</code>
</h3>
<p>The <code>smw</code> object has a generic <code>plot</code> method, <code>plot.smw</code>. This command is a convenience wrapper for accessing and viewing the results cointained in a <code>smw</code> object. Auxiliary arguments from <code>extract</code> (i.e. <code>sig</code>, <code>z</code>, <code>BPs</code> and <code>seq.sig</code>) can be passed to <code>plot.smw</code>. The function returns invisibly a DP table (object class <code>dp</code>) and plots the location of the window midpoints vs. dissimilarity values. By default, significant dissimilarity values are given in “red” and the breakpoints in “blue”.</p>
<p>The background area of the graph can be coloured according to the breakpoints location (argument <code>bg</code>). These colors are controled by the arguments <code>bg</code> and <code>bg_alpha</code>. The colors generated for each sample can be acessed through the command <code>bgDP(dp)</code> (where <code>dp</code> is an object of class <code>dp</code>). As we shall see later, this vector may be useful in the simultaneous visualization of the results the <code>SMW</code> and <code>pwRDA</code>. For the complete list of graphical parameters, please go to <code><a href="https://rdrr.io/r/utils/help.html">help(plot.smw)</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">cex=</span>.<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(pool,<span class="dt">w=</span><span class="dv">20</span>, <span class="dt">main=</span><span class="st">"DP from a single window (10)"</span>, <span class="dt">cex.main=</span>.<span class="dv">8</span>) </a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(pool, <span class="dt">main=</span><span class="st">"DP from pooled windows (10, 20, 30 and 40)"</span>,  <span class="dt">bg=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rainbow"</span>),<span class="dt">cex.main=</span>.<span class="dv">8</span>)</a></code></pre></div>
<p><img src="segRDA_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>A second type of plot is available for <em>pooled</em> <code>smw</code> objects: the window size effect. When the <code>smw</code> object is <em>pooled</em> and the argument <code>w.effect</code> is <code>TRUE</code>, the <code>plot</code> method drawns together the profiles obtained from the different window sizes.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(pool, <span class="dt">w.effect =</span> <span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">"Window size effect"</span>)</a></code></pre></div>
<p><img src="segRDA_files/figure-html/unnamed-chunk-12-1.png" width="384"></p>
</div>
</div>
</div>
<div id="piecewise-redundancy-analysis-pwrda" class="section level1">
<h1 class="hasAnchor">
<a href="#piecewise-redundancy-analysis-pwrda" class="anchor"></a>Piecewise redundancy analysis (pwRDA)</h1>
<p>Once the breakpoints have been defined and their significance tested, the pwRDA can be implemented. It is done with the function <code>pwRDA</code>. The function has three arguments: <code>x</code> explanatory variables, <code>y</code> response variables and <code>BPs</code> the positions of the breakpoints. The function displays a message with the main result of the analysis:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">pw.sim&lt;-<span class="kw">pwRDA</span>(<span class="dt">x.ord=</span>xo,<span class="dt">y.ord=</span>yo, <span class="dt">BPs=</span><span class="kw">bp</span>(pool_dp))</a></code></pre></div>
<p>The function returns an invisible list with following descriptors:</p>
<ul>
<li>
<code>..$summ</code>: a vector containing the summarized statistics.</li>
<li>
<code>..$rda.0</code> and <code>..$rda.pw</code>: the respectives <code>cca</code> objects from the full and “pw”" RDA models. These objects can be used in all functions that applies to <code><a href="https://rdrr.io/pkg/vegan/man/cca.object.html">vegan::cca.object</a></code>. More details for accessing and plotting a <code>cca.object</code> are in <code><a href="https://rdrr.io/r/utils/help.html">help(cca.object)</a></code> and <code><a href="https://rdrr.io/r/utils/help.html">help(plot.cca)</a></code>, respectivaly.</li>
</ul>
<p>Finally, the color vector <code>bg</code> obtained from the command <code>plot.smw</code> can be used for a simultaneous view of the results of the <code>SMW</code> and <code>pwRDA</code> analyses.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(pw.sim<span class="op">$</span>summ)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">##      Statistic     P.value</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">## FULL 0.4762499 0.001000000</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">## PW   0.7632242 0.000000000</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">## F    2.5279984 0.006940479</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">cex=</span>.<span class="dv">75</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># plotting the full rda model:</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(pw.sim<span class="op">$</span>rda<span class="fl">.0</span>, <span class="dt">main=</span><span class="st">"full RDA model"</span>, <span class="dt">las=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co"># plotting the DP profile and keeping the sample colors:</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">dp&lt;-<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(pool, <span class="dt">main=</span><span class="st">"DP from pooled windows </span><span class="ch">\n</span><span class="st"> (10, 20, 30 and 40)"</span>,  <span class="dt">bg=</span><span class="st">'rainbow'</span>,<span class="dt">cex.main=</span>.<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co"># plotting the pwRDA colored according to the breakpoints:</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(pw.sim<span class="op">$</span>rda.pw,<span class="dt">type=</span><span class="st">"n"</span>, <span class="dt">scaling=</span><span class="dv">3</span>, <span class="dt">main=</span><span class="st">"pwRDA model"</span>)</a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(pw.sim<span class="op">$</span>rda.pw, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span><span class="kw">bgDP</span>(dp), <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(pw.sim<span class="op">$</span>rda.pw,  <span class="dt">display=</span><span class="st">"bp"</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">"steelblue4"</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="segRDA_files/figure-html/unnamed-chunk-15-1.png" width="864"></p>
</div>
<div id="literature" class="section level1">
<h1 class="hasAnchor">
<a href="#literature" class="anchor"></a>Literature</h1>
<ol style="list-style-type: decimal">
<li><p>Burrough, P.A. (1986). Principles of Geographical Information Systems for Land Resources Assessment. Journal of Quaternary Sciencee, 193.</p></li>
<li><p>Cornelius, J.M. &amp; Reynolds, J.F. (1991). On Determining the Statistical Significance of Discontinuities with Ordered Ecological Data. Ecology, 72, 2057–2070.</p></li>
<li><p>Erdos, L., Bátori, Z., Tölgyesi, C.S. &amp; Körmöczi, L. (2014). The moving split window (MSW) analysis in vegetation science - An overview. Applied Ecology and Environmental Research, 12, 787–805.</p></li>
<li><p>Körmöczi, L., Bátori, Z., Erdős, L., Tölgyesi, C., Zalatnai, M. &amp; Varró, C. (2016). The role of randomization tests in vegetation boundary detection with moving split-window analysis. Journal of Vegetation Science, 27, 1288–1296.</p></li>
<li><p>Oksanen, J., Blanchet, F.G., Friendly, M., Kindt, R., Legendre, P., McGlinn, D., Minchin, P.R., O’Hara, R.B., Simpson, G.L., Solymos, P., Stevens, M.H.H., Szoecs, E. &amp; Wagner, H. (2017). vegan: Community Ecology Package.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-ordering">Data ordering</a></li>
      <li>
<a href="#split-moving-window-analysis">Split-moving window analysis</a><ul class="nav nav-pills nav-stacked">
<li><a href="#a-brief-overview-of-the-smw-analysis-">A brief overview of the SMW analysis.</a></li>
      <li><a href="#the-function-smw">The function SMW</a></li>
      <li><a href="#methods-for-extracting-and-plotting-the-smw-results">Methods for extracting and plotting the SMW results</a></li>
      </ul>
</li>
      <li><a href="#piecewise-redundancy-analysis-pwrda">Piecewise redundancy analysis (pwRDA)</a></li>
      <li><a href="#literature">Literature</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Danilo C Vieira.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
